using Content.Client.Message;
using Content.Client.UserInterface.Controls;
using Content.Goobstation.Shared.Books;
using Robust.Client.AutoGenerated;
using Robust.Client.UserInterface.XAML;

namespace Content.Goobstation.Client.Books.Ui;

[GenerateTypedNameReferences]
public sealed partial class BookScannerWindow : FancyWindow
{
    public Action? StartPressed;

    public BookScannerWindow()
    {
        RobustXamlLoader.Load(this);

        StartScanningButton.OnPressed += args => StartPressed?.Invoke();
    }

    public void Populate(string author, string genre, string title, string desc, BookScannerState state)
    {
        StartScanningButton.Disabled = state != BookScannerState.Ready || author == "" || genre == "" || title == "";
        StartScanningButton.ToolTip = state switch
        {
            BookScannerState.NoBook => Loc.GetString("book-scanner-no-book-tooltip"),
            BookScannerState.Scanning => Loc.GetString("book-scanner-scanning-tooltip"),
            _ => null
        };

        if (author != "" && genre != "" && title != "" && desc != "")
        {
            AuthorNameLabel.SetMarkup(Loc.GetString("book-scanner-author", ("author", author)));
            GenreLabel.SetMarkup(Loc.GetString("book-scanner-genre", ("genre", genre)));
            TitleLabel.SetMarkup(Loc.GetString("book-scanner-title", ("title", title)));
            DescLabel.SetMarkup(Loc.GetString("book-scanner-desc", ("desc", desc)));
        }
        else
        {
            AuthorNameLabel.SetMarkup(Loc.GetString("book-scanner-no-author"));
            GenreLabel.SetMarkup(Loc.GetString("book-scanner-no-genre"));
            TitleLabel.SetMarkup(Loc.GetString("book-scanner-no-title"));
            DescLabel.SetMarkup(Loc.GetString("book-scanner-no-desc"));
        }
    }
}
