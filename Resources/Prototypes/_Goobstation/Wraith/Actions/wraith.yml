# This file includes all the actions for wraith.
# Revenants, other ghost-roles should get their own directory outside the Wraith one.

#   - type: ActionWraithPoints -> Removes Wraith Points once the action gets handled
#    wpConsume: int -> Amount of Wraith Points to remove

# Base Wraith Actions
- type: entity
  id: ActionHaunt
  name: Haunt
  description: Temporarily become corporeal to scare people and/or gloat. This ability will remain active until used again, with the second use returning you to your incorporeal state. Every witness present gives you an increased rate of WP regeneration.
  components:
  - type: Action
    useDelay: 60
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: haunt
  - type: InstantAction
    event: !type:HauntEvent

- type: entity
  id: ActionWhisper
  parent: DemonicWhisperAction
  name: Whisper
  description: Send a spooky ghost message to somebody, which they hear as "A netherworld voice whispers in your ear..." This, alongside Blood Writing, is your only way to communicate with the living.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithwhisper2.ogg
    useDelay: 5
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: whisper

- type: entity
  id: ActionBloodWriting
  name: Blood Writing
  description: Draws a single letter or pictogram of your choice on tile, complete with fancy animation. At least, that's what it will do. Right now, it just gives you a crayon. #We are absolutely going to rework this :clueless:
  components:
  - type: Action
    useDelay: 5
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: blood_writing
  - type: InstantAction
    event: !type:BloodWritingEvent

- type: entity
  id: ActionAbsorbCorpse
  name: Absorb corpse
  description: Rots a corpse with a cloud of black smoke and boosts WP regeneration. Cooldown lessens with each use but resets on banishment. Can be stopped by formaldehyde.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithsoulsucc1.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: absorb_corpse
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    whitelist:
      requireAll: true
      components:
      - MobState
      - HumanoidAppearance
    event: !type:AbsorbCorpseEvent

- type: entity
  id: ActionSpook
  name: Spook
  description: The first use Marks an area, and the second use lets you choose a spooky thing to do to that area.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithspook1.ogg
    itemIconStyle: BigAction
    useDelay: 30
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: spook
  - type: TargetAction
    range: 10
  - type: WorldTargetAction
    event: !type:SpookEvent

- type: entity
  id: ActionDecay
  name: Decay
  description: When used on living entities, it drains a significant amount of stamina. When used on inanimate objects, it EMAGs them, if possible.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 60
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: decay
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    blacklist:
      components:
      - BorgChassis
    event: !type:DecayEvent

- type: entity
  id: ActionCommand
  name: Command
  description: Hurls a few nearby loose objects at the chosen target.
  components:
  - type: Action
    useDelay: 20
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: command
  - type: TargetAction
    range: 10
  - type: EntityTargetAction
    canTargetSelf: false
    event: !type:WraithCommandEvent

- type: entity
  id: ActionAnimateObject
  parent: ActionAnimateSpell
  name: Animate object
  description: Causes an object to come to life and try to murder anything and everything nearby.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithlivingobject.ogg
    useDelay: 30
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: anim_object

- type: entity
  id: ActionPossessObject
  name: Possess object
  description: Puts your consciousness inside an object for a limited time, letting you fly it around and use it to murder people. While powerful, you are now corporeal, and can be killed in this form.
  components:
  - type: Action
    itemIconStyle: BigAction
    # useDelay: 150
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: possess_object
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    whitelist:
      components:
      - Animateable # Currently on: SeatBase, TableBase, ClosetBase, BaseMachine, ConstructibleMachine, BaseComputer, BaseItem, CrateGeneric, StorageTank, GasCanister
    blacklist:
      components:
      - NukeDisk
      - GravityGenerator
      - AnomalyGenerator
      - TegGenerator
      - TegCirculator
      - XenoArtifact
      - Ghost
      - Spectral
      - FadingTimedDespawn
      - TimedDespawn
    event: !type:PossessObjectEvent
      toAdd:
      - type: Animate
      - type: MindContainer
      - type: InputMover
      - type: MobMover
      - type: CombatMode
      - type: MeleeWeapon
        animation: Slash
        wideAnimation: WeaponArcClaw
        altDisarm: false
        soundHit:
          collection: Flesh_Stab
        range: 1.5
        angle: 0.0
        damage:
          types:
            Slash: 20
      - type: NpcFactionMember
        factions:
        - Wraith
      - type: NoSlip
      - type: MovementSpeedModifier
        baseWalkSpeed: 5
        baseSprintSpeed: 5
      - type: MovementAlwaysTouching
      - type: CanMoveInAir
      - type: Damageable
        damageContainer: ManifestedSpirit
        damageModifierSet: ManifestedSpirit
      - type: Destructible
        thresholds:
        - trigger:
            !type:DamageTrigger
            damage: 300 #Easily killable with holy damage so it has to be somewhat high for it to be worth the wraith risking it
          behaviors:
          - !type:DoActsBehavior
            acts: ["Destruction"]
          - !type:PlaySoundBehavior
            sound:
              collection: MetalBreak
      - type: Hands
      - type: CanEscapeInventory
      - type: MobCollision
      toRemove:
      - RequireProjectileTarget
      - BlockMovement
      - Item
      - MeleeRequiresWield

- type: entity
  id: ActionEvolve
  name: Evolve
  description: With three corpses absorbed, your power has grown. Allows you to pick a path to evolve into.
  components:
  - type: Action
    useDelay: 0
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: evolve
  - type: InstantAction
    event: !type:WraithEvolveEvent

# Harbinger Actions
- type: entity
  id: ActionRaiseSkeleton
  name: Raise skeleton
  description: Commands the skeleton inside a corpse to detonate out and free its brothers still trapped in the living. By murdering them. Best used in combination with Absorb Corpse, because only completely decomposed cadavers can be raised as skeletons. This ability can also be used on closets, spawning one skeleton per closet.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithraise1.ogg
    useDelay: 60
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: skeleton
  - type: TargetAction
    range: 15
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    whitelist:
      components:
      - EntityStorage
      - HumanoidAppearance
    event: !type:RaiseSkeletonEvent

- type: entity
  id: ActionSummonVoidPortal
  name: Summon void portal
  description: Summon a void portal from which otherworldly creatures pour out. You get increased point generation when near it.
  components:
  - type: Action
    useDelay: 150
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: open_portal
  - type: InstantAction
    event: !type:SummonPortalEvent

- type: entity
  id: ActionSummonVoidCreature
  name: Summon void creatures
  description: Randomly picks between one of three powerful void entities to summon.
  components:
  - type: Action
    useDelay: 150
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: summon_creature
  - type: InstantAction
    event: !type:SummonVoidCreatureEvent

- type: entity
  id: ActionMakeRevenant
  name: Make revenant
  description: Allows you to possess a corpse and empower it as a Revenant, so you can murder people with their co-workers. Must be used on a relatively fresh corpse.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/reventer.ogg
    useDelay: 60
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: revenant
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    event: !type:MakeRevenantEvent

# Plaguebringer Actions

- type: entity
  id: ActionCurseBlindness
  name: Curse of blindness
  description: When inflicted with this curse, the affected will experience gradual eye damage over time in small increments of 1. Eventually fully blinds them if not cured.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: blind_curse
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    event: !type:BlindCurseEvent

- type: entity
  id: ActionCurseWeakness
  name: Curse of weakness
  description: Causes regular slowdowns in movement of the afflicted being, as well as drowsiness. #TO DO: Add reduced stamina regeneration
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: weak_curse
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    event: !type:WeakCurseEvent

- type: entity
  id: ActionCurseBlood
  name: Curse of blood
  description: When inflicted with this curse, the affected will experience gradual eye damage over time in small increments of 1. Eventually fully blinds them if not cured.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: blood_curse
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    event: !type:BloodCurseEvent

- type: entity
  id: ActionCurseRot
  name: Curse of rot
  description: When inflicted with this curse, the affected will experience gradual eye damage over time in small increments of 1. Eventually fully blinds them if not cured.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: rot_curse
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    event: !type:RotCurseEvent

- type: entity
  id: ActionCurseDeath
  name: Curse of death
  description: The final, brutal curse that can be placed on a being once all four prior curses have been placed on them. Once afflicted, the target begins to shake and be ripped apart. The curse completes once the target gibs, releasing a large amount of miasma. Counts as a consume, increasing point generation.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 45
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: death_curse
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    whitelist:
      requireAll: true
      components:
      - CursedBlind
      - CursedWeak
      - CurseRot
      - CursedBlood
    event: !type:DeathCurseEvent

- type: entity
  id: ActionDefile
  name: Defile
  description: Manifest some horrible poison inside a food item or a container.
  components:
  - type: Action
    sound: !type:SoundPathSpecifier
      path: /Audio/_Goobstation/Wraith/wraithstaminadrain.ogg
    useDelay: 50
    itemIconStyle: BigAction
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: wraith_poison
  - type: TargetAction
    deselectOnMiss: true
  - type: EntityTargetAction
    canTargetSelf: false
    whitelist:
      requireAll: false
      components:
      - Drink
      - Food
    event: !type:DefileEvent

- type: entity
  id: ActionSummonPlagueRat
  name: Summon Plague rat
  description: Attempt to breach the veil between worlds to allow a plague rat to enter this realm.
  components:
  - type: Action
    useDelay: 150
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: summon_rats
  - type: InstantAction
    event: !type:SummonPlagueRatEvent

- type: entity
  id: ActionSummonRotHulk
  name: Summon Rot Hulk
  description: Assimilate the filth in an area and create an unstable servant.
  components:
  - type: Action
    useDelay: 90
    icon:
      sprite: _Goobstation/Wraith/actions.rsi
      state: summon_goo
  - type: InstantAction
    event: !type:SummonRotHulkEvent

# Trickster Actions
