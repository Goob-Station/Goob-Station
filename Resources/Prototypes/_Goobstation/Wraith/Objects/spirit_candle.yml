- type: entity
  name: spirit candle
  parent: Candle
  id: Spirit Candle
  components:
  - type: Item
    size: Tiny
  - type: Sprite
    sprite: _Goobstation/Wraith/Objects/spirit_candle.rsi
    layers:
    - state: unmelted-unlit
    - state: eyes
      map: [ "enum.SpiritCandleVisuals.Layer" ]
      visible: true
  - type: SpiritCandle # holds logic and visuals
  - type: FireVisuals
    sprite: _Goobstation/Wraith/Objects/spirit_candle.rsi
    normalState: unmelted-lit
    lightColor: "#0000FF"
  - type: ToggleableVisuals
    spriteLayer: null
    inhandVisuals:
      left:
      - state: inhand-left-flame
        shader: unshaded
      right:
      - state: inhand-right-flame
        shader: unshaded
  - type: LimitedCharges
    maxCharges: 2
  - type: UseDelay
    delay: 17 # as long as the status effects last + grace period for escape
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 60
      behaviors:
      - !type:SpawnEntitiesBehavior
      - !type:DoActsBehavior
        acts: [ "Destruction" ]

# dummy entity for detecting
- type: entity
  id: SpiritCandleRevealArea
  name: spirit candle area
  description: You shouldn't see this.
  components:
  - type: SpiritCandleArea
    whitelist:
      components:
      - Wraith
  - type: Transform
  - type: Physics
    bodyType: Dynamic
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeAabb
          bounds: "-6, -6, 6, 6" # 12x12 tile area
        density: 1
        hard: false
        mask:
        - GhostImpassable
