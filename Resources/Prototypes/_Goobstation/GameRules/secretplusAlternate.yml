# SPDX-FileCopyrightText: 2025 SaffronFennec <firefoxwolf2020@protonmail.com>
#
# SPDX-License-Identifier: AGPL-3.0-or-later

# File for alternate secret+ rulesets that rely on mode-specific gamerules
# Gamemodes
- type: entity
  id: SecretPlusClassic 
  parent: SecretPlusMid
  categories: [ HideSpawnMenu ]
  components:
  - type: SecretPlus
    minStartingChaos: 0 # Classic doesn't rely on chaos gamestart
    maxStartingChaos: 0
    PrimaryAntagsWeightTable: SecretPlusClassicMain
    RoundStartAntagsWeightTable: SecretPlusClassicSide # Every main rule costs -1, and every side rule only 1- only 1 side antag rolls
    livingChaosChange: -0.01 # inbetween med and light
    deadChaosChange: 0.02

# Tables

- type: entity
  parent: BaseGameRule
  id: SubGamemodesRuleClassic # Currently kinda scuffed w/ only 2 side antags, when there's 3-6 it should work better- try and make it select 2 side antags on average when there's 3+
  components:
  - type: SubGamemodes
    rules: # CurrentlY 37.5% chance of thief alone, 37.5% both, 12.5% Devil alone, 12.5% 0 antags- gonna be 10x harder to calculate later lol
    - id: Thief
      prob: 0.75 # Decrease to 0.65-0.4 when there's more antags
    - id: Devil 
      prob: 0.5 # Decrease to 0.4-0.3 when there's more antags

- type: weightedRandom
  id: SecretPlusClassicMain
  weights:
    # Minor Antags - 76% -1% for every rare antag [currently 74%]
    TraitorClassicMain: 0.37 # should be 2x others
    ChangelingClassicMain: 0.185
    HereticClassicMain: 0.185
    # Major Antags - 24%
    NukeopsNoChaos: 0.08
    RevolutionaryNoChaos: 0.08
    CosmicCultNoChaos: 0.08
   # Shadowlings: 0.06 - at 4 majors make all 0.06, then 0.0475... etc
    # Rare Antags - 1% of minors per rare antag [currently 2%]
    ZombieNoChaos: 0.01 # lol, lmao even- it's barely an antag that's seen ever anyways and rarely liked, let's see it even less
    HonkopsNoChaos: 0.01 # same chance as regular secret

- type: weightedRandom
  id: SecretPlusClassicSide
  weights:
    # Minor Antags 60% + the 28% Chance for the side antags gamerule
    TraitorClassicSide: 0.30 # should be 2x the others
    ChangelingClassicSide: 0.15
    HereticClassicSide: 0.15
    SubGamemodesRuleClassic: 0.28
    # Major Solo - 12% Chance to ruin your antag run:tm: 
    BlobNoChaos: 0.06
    WizardNoChaos: 0.06

# Gamerules
- type: entity
  parent: Traitor
  id: TraitorClassicMain
  components:
  - type: GameRule
    minPlayers: 10
    chaosScore: -1
  - type: AntagSelection
    selectionTime: IntraPlayerSpawn # Goobstation
    definitions:
    - prefRoles: [ Traitor ]
      max: 7
      playerRatio: 10
      blacklist:
        components:
        - AntagImmune
        - Changeling # Goobstation
      lateJoinAdditional: true
      mindRoles:
      - MindRoleTraitor

- type: entity
  parent: Traitor
  id: TraitorClassicSide
  components:
  - type: GameRule
    minPlayers: 18
    chaosScore: 1 
  - type: AntagSelection
    selectionTime: IntraPlayerSpawn # Goobstation
    definitions:
    - prefRoles: [ Traitor ]
      max: 4
      playerRatio: 18
      blacklist:
        components:
        - AntagImmune
        - Changeling # Goobstation
      lateJoinAdditional: true
      mindRoles:
      - MindRoleTraitor 

- type: entity
  parent: Changeling
  id: ChangelingClassicMain
  components:
  - type: GameRule
    minPlayers: 12
    chaosScore: -1
  - type: AntagSelection
    selectionTime: IntraPlayerSpawn
    agentName: changeling-roundend-name
    definitions:
    - prefRoles: [ Changeling ]
      max: 5
      playerRatio: 15
      lateJoinAdditional: true
      mindRoles:
      - MindRoleChangeling

- type: entity
  parent: Changeling
  id: ChangelingClassicSide
  components:
  - type: GameRule
    minPlayers: 25
    chaosScore: 1
  - type: AntagSelection
    selectionTime: IntraPlayerSpawn
    agentName: changeling-roundend-name
    definitions:
    - prefRoles: [ Changeling ]
      max: 3
      playerRatio: 25
      lateJoinAdditional: true
      mindRoles:
      - MindRoleChangeling
      
- type: entity
  parent: Heretic
  id: HereticClassicMain
  components:
  - type: GameRule
    minPlayers: 15
    chaosScore: -1
  - type: AntagSelection
    selectionTime: IntraPlayerSpawn
    agentName: heretic-roundend-name
    definitions:
    - prefRoles: [ Heretic ]
      max: 5
      playerRatio: 15
      lateJoinAdditional: true
      jobBlacklist: [ Chaplain ] # GOOBSTATION
      mindRoles:
      - MindRoleHeretic
      components:
      - type: WeakToHoly
      - type: CanEnchant

- type: entity
  parent: Heretic
  id: HereticClassicSide
  components:
  - type: GameRule
    minPlayers: 25
    chaosScore: 1
  - type: AntagSelection
    selectionTime: IntraPlayerSpawn
    agentName: heretic-roundend-name
    definitions:
    - prefRoles: [ Heretic ]
      max: 3
      playerRatio: 25
      lateJoinAdditional: true
      jobBlacklist: [ Chaplain ] # GOOBSTATION
      mindRoles:
      - MindRoleHeretic
      components:
      - type: WeakToHoly
      - type: CanEnchant

# No Chaos Gamerules [technically -1/1, who cares]

- type: entity
  parent: Revolutionary
  id: RevolutionaryNoChaos
  components:
  - type: GameRule
    minPlayers: 15
    chaosScore: -1

- type: entity
  parent: Nukeops
  id: NukeopsNoChaos
  components:
  - type: GameRule
    minPlayers: 20
    chaosScore: -1

- type: entity
  parent: CosmicCult
  id: CosmicCultNoChaos
  components:
  - type: GameRule
    minPlayers: 25
    chaosScore: -1

- type: entity
  parent: BlobGameMode
  id: BlobNoChaos
  components:
  - type: GameRule
    minPlayers: 15
    chaosScore: 1

- type: entity
  parent: Honkops
  id: HonkopsNoChaos
  components:
  - type: GameRule
    minPlayers: 20
    chaosScore: -1

- type: entity
  parent: Wizard
  id: WizardNoChaos
  components:
  - type: GameRule
    minPlayers: 30
    chaosScore: 1

- type: entity
  parent: Zombie
  id: ZombieNoChaos
  components:
  - type: GameRule
    minPlayers: 30
    chaosScore: -1
